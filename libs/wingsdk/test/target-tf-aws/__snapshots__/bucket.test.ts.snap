// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`bucket is public 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_s3_bucket\\": {
      \\"root_mybucket_E5DAA363\\": {
        \\"bucket_prefix\\": \\"my-bucket-c8045fcc-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_policy\\": {
      \\"root_mybucket_PublicPolicy_2A65F5BE\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":\\\\\\"*\\\\\\",\\\\\\"Action\\\\\\":[\\\\\\"s3:GetObject\\\\\\"],\\\\\\"Resource\\\\\\":[\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}/*\\\\\\"]}]}\\"
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_mybucket_PublicAccessBlock_3EF88EB3\\": {
        \\"block_public_acls\\": false,
        \\"block_public_policy\\": false,
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"ignore_public_acls\\": false,
        \\"restrict_public_buckets\\": false
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_mybucket_Encryption_AA43F7E8\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    }
  }
}"
`;

exports[`bucket is public 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
              "my_bucket": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/my_bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/my_bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/my_bucket/PublicAccessBlock",
                  },
                  "PublicPolicy": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicPolicy",
                    "path": "root/Default/my_bucket/PublicPolicy",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "my_bucket",
                "path": "root/Default/my_bucket",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;

exports[`bucket prefix must be lowercase 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_s3_bucket\\": {
      \\"root_TheUncannyBucket_9FBBB2ED\\": {
        \\"bucket_prefix\\": \\"the-uncanny-bucket-c88a0953-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_TheUncannyBucket_PublicAccessBlock_FCE6031A\\": {
        \\"block_public_acls\\": true,
        \\"block_public_policy\\": true,
        \\"bucket\\": \\"\${aws_s3_bucket.root_TheUncannyBucket_9FBBB2ED.bucket}\\",
        \\"ignore_public_acls\\": true,
        \\"restrict_public_buckets\\": true
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_TheUncannyBucket_Encryption_E43D3F83\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_TheUncannyBucket_9FBBB2ED.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    }
  }
}"
`;

exports[`bucket prefix must be lowercase 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "The-Uncanny.Bucket": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/The-Uncanny.Bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/The-Uncanny.Bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/The-Uncanny.Bucket/PublicAccessBlock",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "The-Uncanny.Bucket",
                "path": "root/Default/The-Uncanny.Bucket",
              },
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;

exports[`bucket prefix valid 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_s3_bucket\\": {
      \\"root_theuncannybucket_03A74E00\\": {
        \\"bucket_prefix\\": \\"the-uncanny-bucket-c8e2755c-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_theuncannybucket_PublicAccessBlock_976A73D7\\": {
        \\"block_public_acls\\": true,
        \\"block_public_policy\\": true,
        \\"bucket\\": \\"\${aws_s3_bucket.root_theuncannybucket_03A74E00.bucket}\\",
        \\"ignore_public_acls\\": true,
        \\"restrict_public_buckets\\": true
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_theuncannybucket_Encryption_1294028A\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_theuncannybucket_03A74E00.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    }
  }
}"
`;

exports[`bucket prefix valid 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
              "the-uncanny.bucket": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/the-uncanny.bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/the-uncanny.bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/the-uncanny.bucket/PublicAccessBlock",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "the-uncanny.bucket",
                "path": "root/Default/the-uncanny.bucket",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;

exports[`bucket with onCreate method 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_iam_role\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRole_048D6026\\": {
        \\"assume_role_policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":\\\\\\"sts:AssumeRole\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"lambda.amazonaws.com\\\\\\"},\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\"}]}\\"
      }
    },
    \\"aws_iam_role_policy\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRolePolicy_0CF972A9\\": {
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Action\\\\\\":\\\\\\"none:null\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"*\\\\\\"}]}\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRole_048D6026.name}\\"
      }
    },
    \\"aws_iam_role_policy_attachment\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRolePolicyAttachment_B46CE900\\": {
        \\"policy_arn\\": \\"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRole_048D6026.name}\\"
      }
    },
    \\"aws_lambda_function\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_EAEF907E\\": {
        \\"environment\\": {
          \\"variables\\": {
            \\"WING_FUNCTION_NAME\\": \\"my_bucket-on_create-OnMessage-2c90a36b-c87c1659\\"
          }
        },
        \\"function_name\\": \\"my_bucket-on_create-OnMessage-2c90a36b-c87c1659\\",
        \\"handler\\": \\"index.handler\\",
        \\"publish\\": true,
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRole_048D6026.arn}\\",
        \\"runtime\\": \\"nodejs18.x\\",
        \\"s3_bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"s3_key\\": \\"\${aws_s3_object.root_mybucket_mybucketoncreateOnMessage2c90a36b_S3Object_DDC97BAE.key}\\",
        \\"timeout\\": 30,
        \\"vpc_config\\": {
          \\"security_group_ids\\": [],
          \\"subnet_ids\\": []
        }
      }
    },
    \\"aws_lambda_permission\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_InvokePermissionc8ab9ab84a159fe2b8ace0993118785a21c0508190_E384F8CE\\": {
        \\"action\\": \\"lambda:InvokeFunction\\",
        \\"function_name\\": \\"\${aws_lambda_function.root_mybucket_mybucketoncreateOnMessage2c90a36b_EAEF907E.function_name}\\",
        \\"principal\\": \\"sns.amazonaws.com\\",
        \\"source_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\"
      }
    },
    \\"aws_s3_bucket\\": {
      \\"root_Code_02F3C603\\": {
        \\"bucket_prefix\\": \\"code-c84a50b1-\\"
      },
      \\"root_mybucket_E5DAA363\\": {
        \\"bucket_prefix\\": \\"my-bucket-c8045fcc-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_notification\\": {
      \\"root_mybucket_S3BucketNotification_008BD786\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.id}\\",
        \\"depends_on\\": [
          \\"aws_sns_topic_policy.root_mybucket_mybucketoncreate_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_EF6799F2\\"
        ],
        \\"topic\\": [
          {
            \\"events\\": [
              \\"s3:ObjectCreated:Put\\"
            ],
            \\"id\\": \\"on-create-notification\\",
            \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\"
          }
        ]
      }
    },
    \\"aws_s3_bucket_policy\\": {
      \\"root_mybucket_PublicPolicy_2A65F5BE\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":\\\\\\"*\\\\\\",\\\\\\"Action\\\\\\":[\\\\\\"s3:GetObject\\\\\\"],\\\\\\"Resource\\\\\\":[\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}/*\\\\\\"]}]}\\"
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_mybucket_PublicAccessBlock_3EF88EB3\\": {
        \\"block_public_acls\\": false,
        \\"block_public_policy\\": false,
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"ignore_public_acls\\": false,
        \\"restrict_public_buckets\\": false
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_mybucket_Encryption_AA43F7E8\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    },
    \\"aws_s3_object\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_S3Object_DDC97BAE\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"key\\": \\"<key>\\",
        \\"source\\": \\"<source>\\"
      }
    },
    \\"aws_sns_topic\\": {
      \\"root_mybucket_mybucketoncreate_A862D5F2\\": {
        \\"name\\": \\"my_bucket-on_create-c8ab9ab8\\"
      }
    },
    \\"aws_sns_topic_policy\\": {
      \\"root_mybucket_mybucketoncreate_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_EF6799F2\\": {
        \\"arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\",
        \\"policy\\": \\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"s3.amazonaws.com\\\\\\"},\\\\\\"Action\\\\\\":\\\\\\"sns:Publish\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\\\\\",\\\\\\"Condition\\\\\\":{\\\\\\"ArnEquals\\\\\\":{\\\\\\"aws:SourceArn\\\\\\":\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}\\\\\\"}}}]}\\"
      }
    },
    \\"aws_sns_topic_subscription\\": {
      \\"root_mybucket_mybucketoncreate_mybucketoncreateTopicSubscription2c90a36b_30C838B1\\": {
        \\"endpoint\\": \\"\${aws_lambda_function.root_mybucket_mybucketoncreateOnMessage2c90a36b_EAEF907E.arn}\\",
        \\"protocol\\": \\"lambda\\",
        \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\"
      }
    }
  }
}"
`;

exports[`bucket with onCreate method 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "Code": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformResource",
                  "version": "0.15.2",
                },
                "id": "Code",
                "path": "root/Default/Code",
              },
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
              "inflight": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "An inflight resource",
                  "hidden": true,
                  "title": "Inflight",
                },
                "id": "inflight",
                "path": "root/Default/inflight",
              },
              "my_bucket": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "outbound",
                      "implicit": false,
                      "relationship": "CREATE",
                      "resource": "root/Default/my_bucket/my_bucket-on_create",
                    },
                  ],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/my_bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/my_bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/my_bucket/PublicAccessBlock",
                  },
                  "PublicPolicy": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicPolicy",
                    "path": "root/Default/my_bucket/PublicPolicy",
                  },
                  "S3BucketNotification": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "S3BucketNotification",
                    "path": "root/Default/my_bucket/S3BucketNotification",
                  },
                  "my_bucket-on_create": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "CREATE",
                          "resource": "root/Default/my_bucket",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b",
                        },
                      ],
                    },
                    "children": {
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_create/Default",
                      },
                      "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                        "path": "root/Default/my_bucket/my_bucket-on_create/PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                      },
                      "my_bucket-on_create-TopicSubscription-2c90a36b": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "my_bucket-on_create-TopicSubscription-2c90a36b",
                        "path": "root/Default/my_bucket/my_bucket-on_create/my_bucket-on_create-TopicSubscription-2c90a36b",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A pub/sub notification topic",
                      "title": "Topic",
                    },
                    "id": "my_bucket-on_create",
                    "path": "root/Default/my_bucket/my_bucket-on_create",
                  },
                  "my_bucket-on_create-OnMessage-2c90a36b": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/inflight",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/my_bucket-on_create-eventHandler-9eade8f6",
                        },
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_create",
                        },
                      ],
                    },
                    "children": {
                      "Asset": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformAsset",
                          "version": "0.15.2",
                        },
                        "id": "Asset",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/Asset",
                      },
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/Default",
                      },
                      "IamRole": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRole",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/IamRole",
                      },
                      "IamRolePolicy": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicy",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/IamRolePolicy",
                      },
                      "IamRolePolicyAttachment": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicyAttachment",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/IamRolePolicyAttachment",
                      },
                      "InvokePermission-c8ab9ab84a159fe2b8ace0993118785a21c0508190": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "InvokePermission-c8ab9ab84a159fe2b8ace0993118785a21c0508190",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/InvokePermission-c8ab9ab84a159fe2b8ace0993118785a21c0508190",
                      },
                      "S3Object": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "S3Object",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/S3Object",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A cloud function (FaaS)",
                      "title": "Function",
                    },
                    "id": "my_bucket-on_create-OnMessage-2c90a36b",
                    "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b",
                  },
                  "my_bucket-on_create-OnMessageHandler-2c90a36b": {
                    "attributes": {
                      "wing:resource:connections": [],
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "hidden": true,
                    },
                    "id": "my_bucket-on_create-OnMessageHandler-2c90a36b",
                    "path": "root/Default/my_bucket/my_bucket-on_create-OnMessageHandler-2c90a36b",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "my_bucket",
                "path": "root/Default/my_bucket",
              },
              "my_bucket-on_create-eventHandler-9eade8f6": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "hidden": true,
                },
                "id": "my_bucket-on_create-eventHandler-9eade8f6",
                "path": "root/Default/my_bucket-on_create-eventHandler-9eade8f6",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;

exports[`bucket with onDelete method 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_iam_role\\": {
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRole_86A910D1\\": {
        \\"assume_role_policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":\\\\\\"sts:AssumeRole\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"lambda.amazonaws.com\\\\\\"},\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\"}]}\\"
      }
    },
    \\"aws_iam_role_policy\\": {
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRolePolicy_0E5CE887\\": {
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Action\\\\\\":\\\\\\"none:null\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"*\\\\\\"}]}\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRole_86A910D1.name}\\"
      }
    },
    \\"aws_iam_role_policy_attachment\\": {
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRolePolicyAttachment_8291BC09\\": {
        \\"policy_arn\\": \\"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRole_86A910D1.name}\\"
      }
    },
    \\"aws_lambda_function\\": {
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_43EA3B17\\": {
        \\"environment\\": {
          \\"variables\\": {
            \\"WING_FUNCTION_NAME\\": \\"my_bucket-on_delete-OnMessage-f22c8a47-c8e50f60\\"
          }
        },
        \\"function_name\\": \\"my_bucket-on_delete-OnMessage-f22c8a47-c8e50f60\\",
        \\"handler\\": \\"index.handler\\",
        \\"publish\\": true,
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRole_86A910D1.arn}\\",
        \\"runtime\\": \\"nodejs18.x\\",
        \\"s3_bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"s3_key\\": \\"\${aws_s3_object.root_mybucket_mybucketondeleteOnMessagef22c8a47_S3Object_2F148230.key}\\",
        \\"timeout\\": 30,
        \\"vpc_config\\": {
          \\"security_group_ids\\": [],
          \\"subnet_ids\\": []
        }
      }
    },
    \\"aws_lambda_permission\\": {
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_InvokePermissionc80912e0ab47291ff9b0dd966e259f42a42646bcdc_C3350012\\": {
        \\"action\\": \\"lambda:InvokeFunction\\",
        \\"function_name\\": \\"\${aws_lambda_function.root_mybucket_mybucketondeleteOnMessagef22c8a47_43EA3B17.function_name}\\",
        \\"principal\\": \\"sns.amazonaws.com\\",
        \\"source_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\"
      }
    },
    \\"aws_s3_bucket\\": {
      \\"root_Code_02F3C603\\": {
        \\"bucket_prefix\\": \\"code-c84a50b1-\\"
      },
      \\"root_mybucket_E5DAA363\\": {
        \\"bucket_prefix\\": \\"my-bucket-c8045fcc-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_notification\\": {
      \\"root_mybucket_S3BucketNotification_008BD786\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.id}\\",
        \\"depends_on\\": [
          \\"aws_sns_topic_policy.root_mybucket_mybucketondelete_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_79FF94E2\\"
        ],
        \\"topic\\": [
          {
            \\"events\\": [
              \\"s3:ObjectRemoved:*\\"
            ],
            \\"id\\": \\"on-delete-notification\\",
            \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\"
          }
        ]
      }
    },
    \\"aws_s3_bucket_policy\\": {
      \\"root_mybucket_PublicPolicy_2A65F5BE\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":\\\\\\"*\\\\\\",\\\\\\"Action\\\\\\":[\\\\\\"s3:GetObject\\\\\\"],\\\\\\"Resource\\\\\\":[\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}/*\\\\\\"]}]}\\"
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_mybucket_PublicAccessBlock_3EF88EB3\\": {
        \\"block_public_acls\\": false,
        \\"block_public_policy\\": false,
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"ignore_public_acls\\": false,
        \\"restrict_public_buckets\\": false
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_mybucket_Encryption_AA43F7E8\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    },
    \\"aws_s3_object\\": {
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_S3Object_2F148230\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"key\\": \\"<key>\\",
        \\"source\\": \\"<source>\\"
      }
    },
    \\"aws_sns_topic\\": {
      \\"root_mybucket_mybucketondelete_9854917D\\": {
        \\"name\\": \\"my_bucket-on_delete-c80912e0\\"
      }
    },
    \\"aws_sns_topic_policy\\": {
      \\"root_mybucket_mybucketondelete_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_79FF94E2\\": {
        \\"arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\",
        \\"policy\\": \\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"s3.amazonaws.com\\\\\\"},\\\\\\"Action\\\\\\":\\\\\\"sns:Publish\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\\\\\",\\\\\\"Condition\\\\\\":{\\\\\\"ArnEquals\\\\\\":{\\\\\\"aws:SourceArn\\\\\\":\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}\\\\\\"}}}]}\\"
      }
    },
    \\"aws_sns_topic_subscription\\": {
      \\"root_mybucket_mybucketondelete_mybucketondeleteTopicSubscriptionf22c8a47_D4E0F053\\": {
        \\"endpoint\\": \\"\${aws_lambda_function.root_mybucket_mybucketondeleteOnMessagef22c8a47_43EA3B17.arn}\\",
        \\"protocol\\": \\"lambda\\",
        \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\"
      }
    }
  }
}"
`;

exports[`bucket with onDelete method 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "Code": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformResource",
                  "version": "0.15.2",
                },
                "id": "Code",
                "path": "root/Default/Code",
              },
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
              "inflight": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "An inflight resource",
                  "hidden": true,
                  "title": "Inflight",
                },
                "id": "inflight",
                "path": "root/Default/inflight",
              },
              "my_bucket": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "outbound",
                      "implicit": false,
                      "relationship": "DELETE",
                      "resource": "root/Default/my_bucket/my_bucket-on_delete",
                    },
                  ],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/my_bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/my_bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/my_bucket/PublicAccessBlock",
                  },
                  "PublicPolicy": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicPolicy",
                    "path": "root/Default/my_bucket/PublicPolicy",
                  },
                  "S3BucketNotification": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "S3BucketNotification",
                    "path": "root/Default/my_bucket/S3BucketNotification",
                  },
                  "my_bucket-on_delete": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "DELETE",
                          "resource": "root/Default/my_bucket",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47",
                        },
                      ],
                    },
                    "children": {
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_delete/Default",
                      },
                      "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                        "path": "root/Default/my_bucket/my_bucket-on_delete/PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                      },
                      "my_bucket-on_delete-TopicSubscription-f22c8a47": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "my_bucket-on_delete-TopicSubscription-f22c8a47",
                        "path": "root/Default/my_bucket/my_bucket-on_delete/my_bucket-on_delete-TopicSubscription-f22c8a47",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A pub/sub notification topic",
                      "title": "Topic",
                    },
                    "id": "my_bucket-on_delete",
                    "path": "root/Default/my_bucket/my_bucket-on_delete",
                  },
                  "my_bucket-on_delete-OnMessage-f22c8a47": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/inflight",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/my_bucket-on_delete-eventHandler-9eade8f6",
                        },
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_delete",
                        },
                      ],
                    },
                    "children": {
                      "Asset": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformAsset",
                          "version": "0.15.2",
                        },
                        "id": "Asset",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/Asset",
                      },
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/Default",
                      },
                      "IamRole": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRole",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/IamRole",
                      },
                      "IamRolePolicy": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicy",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/IamRolePolicy",
                      },
                      "IamRolePolicyAttachment": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicyAttachment",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/IamRolePolicyAttachment",
                      },
                      "InvokePermission-c80912e0ab47291ff9b0dd966e259f42a42646bcdc": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "InvokePermission-c80912e0ab47291ff9b0dd966e259f42a42646bcdc",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/InvokePermission-c80912e0ab47291ff9b0dd966e259f42a42646bcdc",
                      },
                      "S3Object": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "S3Object",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/S3Object",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A cloud function (FaaS)",
                      "title": "Function",
                    },
                    "id": "my_bucket-on_delete-OnMessage-f22c8a47",
                    "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47",
                  },
                  "my_bucket-on_delete-OnMessageHandler-f22c8a47": {
                    "attributes": {
                      "wing:resource:connections": [],
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "hidden": true,
                    },
                    "id": "my_bucket-on_delete-OnMessageHandler-f22c8a47",
                    "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessageHandler-f22c8a47",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "my_bucket",
                "path": "root/Default/my_bucket",
              },
              "my_bucket-on_delete-eventHandler-9eade8f6": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "hidden": true,
                },
                "id": "my_bucket-on_delete-eventHandler-9eade8f6",
                "path": "root/Default/my_bucket-on_delete-eventHandler-9eade8f6",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;

exports[`bucket with onEvent method 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_iam_role\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRole_048D6026\\": {
        \\"assume_role_policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":\\\\\\"sts:AssumeRole\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"lambda.amazonaws.com\\\\\\"},\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\"}]}\\"
      },
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRole_86A910D1\\": {
        \\"assume_role_policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":\\\\\\"sts:AssumeRole\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"lambda.amazonaws.com\\\\\\"},\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\"}]}\\"
      },
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_IamRole_C2D0AC31\\": {
        \\"assume_role_policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":\\\\\\"sts:AssumeRole\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"lambda.amazonaws.com\\\\\\"},\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\"}]}\\"
      }
    },
    \\"aws_iam_role_policy\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRolePolicy_0CF972A9\\": {
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Action\\\\\\":\\\\\\"none:null\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"*\\\\\\"}]}\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRole_048D6026.name}\\"
      },
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRolePolicy_0E5CE887\\": {
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Action\\\\\\":\\\\\\"none:null\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"*\\\\\\"}]}\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRole_86A910D1.name}\\"
      },
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_IamRolePolicy_AC650E7C\\": {
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Action\\\\\\":\\\\\\"none:null\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"*\\\\\\"}]}\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketonupdateOnMessage32b7a290_IamRole_C2D0AC31.name}\\"
      }
    },
    \\"aws_iam_role_policy_attachment\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRolePolicyAttachment_B46CE900\\": {
        \\"policy_arn\\": \\"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRole_048D6026.name}\\"
      },
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRolePolicyAttachment_8291BC09\\": {
        \\"policy_arn\\": \\"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRole_86A910D1.name}\\"
      },
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_IamRolePolicyAttachment_88C3931D\\": {
        \\"policy_arn\\": \\"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketonupdateOnMessage32b7a290_IamRole_C2D0AC31.name}\\"
      }
    },
    \\"aws_lambda_function\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_EAEF907E\\": {
        \\"environment\\": {
          \\"variables\\": {
            \\"WING_FUNCTION_NAME\\": \\"my_bucket-on_create-OnMessage-2c90a36b-c87c1659\\"
          }
        },
        \\"function_name\\": \\"my_bucket-on_create-OnMessage-2c90a36b-c87c1659\\",
        \\"handler\\": \\"index.handler\\",
        \\"publish\\": true,
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketoncreateOnMessage2c90a36b_IamRole_048D6026.arn}\\",
        \\"runtime\\": \\"nodejs18.x\\",
        \\"s3_bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"s3_key\\": \\"\${aws_s3_object.root_mybucket_mybucketoncreateOnMessage2c90a36b_S3Object_DDC97BAE.key}\\",
        \\"timeout\\": 30,
        \\"vpc_config\\": {
          \\"security_group_ids\\": [],
          \\"subnet_ids\\": []
        }
      },
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_43EA3B17\\": {
        \\"environment\\": {
          \\"variables\\": {
            \\"WING_FUNCTION_NAME\\": \\"my_bucket-on_delete-OnMessage-f22c8a47-c8e50f60\\"
          }
        },
        \\"function_name\\": \\"my_bucket-on_delete-OnMessage-f22c8a47-c8e50f60\\",
        \\"handler\\": \\"index.handler\\",
        \\"publish\\": true,
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketondeleteOnMessagef22c8a47_IamRole_86A910D1.arn}\\",
        \\"runtime\\": \\"nodejs18.x\\",
        \\"s3_bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"s3_key\\": \\"\${aws_s3_object.root_mybucket_mybucketondeleteOnMessagef22c8a47_S3Object_2F148230.key}\\",
        \\"timeout\\": 30,
        \\"vpc_config\\": {
          \\"security_group_ids\\": [],
          \\"subnet_ids\\": []
        }
      },
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_F83D69C0\\": {
        \\"environment\\": {
          \\"variables\\": {
            \\"WING_FUNCTION_NAME\\": \\"my_bucket-on_update-OnMessage-32b7a290-c875bcdf\\"
          }
        },
        \\"function_name\\": \\"my_bucket-on_update-OnMessage-32b7a290-c875bcdf\\",
        \\"handler\\": \\"index.handler\\",
        \\"publish\\": true,
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketonupdateOnMessage32b7a290_IamRole_C2D0AC31.arn}\\",
        \\"runtime\\": \\"nodejs18.x\\",
        \\"s3_bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"s3_key\\": \\"\${aws_s3_object.root_mybucket_mybucketonupdateOnMessage32b7a290_S3Object_DD9A4CB9.key}\\",
        \\"timeout\\": 30,
        \\"vpc_config\\": {
          \\"security_group_ids\\": [],
          \\"subnet_ids\\": []
        }
      }
    },
    \\"aws_lambda_permission\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_InvokePermissionc8ab9ab84a159fe2b8ace0993118785a21c0508190_E384F8CE\\": {
        \\"action\\": \\"lambda:InvokeFunction\\",
        \\"function_name\\": \\"\${aws_lambda_function.root_mybucket_mybucketoncreateOnMessage2c90a36b_EAEF907E.function_name}\\",
        \\"principal\\": \\"sns.amazonaws.com\\",
        \\"source_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\"
      },
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_InvokePermissionc80912e0ab47291ff9b0dd966e259f42a42646bcdc_C3350012\\": {
        \\"action\\": \\"lambda:InvokeFunction\\",
        \\"function_name\\": \\"\${aws_lambda_function.root_mybucket_mybucketondeleteOnMessagef22c8a47_43EA3B17.function_name}\\",
        \\"principal\\": \\"sns.amazonaws.com\\",
        \\"source_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\"
      },
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_InvokePermissionc8c80ce55fb2dfdf6262f75ee093ef99cc30a57833_A8A628D7\\": {
        \\"action\\": \\"lambda:InvokeFunction\\",
        \\"function_name\\": \\"\${aws_lambda_function.root_mybucket_mybucketonupdateOnMessage32b7a290_F83D69C0.function_name}\\",
        \\"principal\\": \\"sns.amazonaws.com\\",
        \\"source_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\"
      }
    },
    \\"aws_s3_bucket\\": {
      \\"root_Code_02F3C603\\": {
        \\"bucket_prefix\\": \\"code-c84a50b1-\\"
      },
      \\"root_mybucket_E5DAA363\\": {
        \\"bucket_prefix\\": \\"my-bucket-c8045fcc-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_notification\\": {
      \\"root_mybucket_S3BucketNotification_008BD786\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.id}\\",
        \\"depends_on\\": [
          \\"aws_sns_topic_policy.root_mybucket_mybucketoncreate_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_EF6799F2\\",
          \\"aws_sns_topic_policy.root_mybucket_mybucketonupdate_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_FD9F0448\\",
          \\"aws_sns_topic_policy.root_mybucket_mybucketondelete_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_79FF94E2\\"
        ],
        \\"topic\\": [
          {
            \\"events\\": [
              \\"s3:ObjectCreated:Put\\"
            ],
            \\"id\\": \\"on-create-notification\\",
            \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\"
          },
          {
            \\"events\\": [
              \\"s3:ObjectCreated:Post\\"
            ],
            \\"id\\": \\"on-update-notification\\",
            \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\"
          },
          {
            \\"events\\": [
              \\"s3:ObjectRemoved:*\\"
            ],
            \\"id\\": \\"on-delete-notification\\",
            \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\"
          }
        ]
      }
    },
    \\"aws_s3_bucket_policy\\": {
      \\"root_mybucket_PublicPolicy_2A65F5BE\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":\\\\\\"*\\\\\\",\\\\\\"Action\\\\\\":[\\\\\\"s3:GetObject\\\\\\"],\\\\\\"Resource\\\\\\":[\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}/*\\\\\\"]}]}\\"
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_mybucket_PublicAccessBlock_3EF88EB3\\": {
        \\"block_public_acls\\": false,
        \\"block_public_policy\\": false,
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"ignore_public_acls\\": false,
        \\"restrict_public_buckets\\": false
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_mybucket_Encryption_AA43F7E8\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    },
    \\"aws_s3_object\\": {
      \\"root_mybucket_mybucketoncreateOnMessage2c90a36b_S3Object_DDC97BAE\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"key\\": \\"<key>\\",
        \\"source\\": \\"<source>\\"
      },
      \\"root_mybucket_mybucketondeleteOnMessagef22c8a47_S3Object_2F148230\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"key\\": \\"<key>\\",
        \\"source\\": \\"<source>\\"
      },
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_S3Object_DD9A4CB9\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"key\\": \\"<key>\\",
        \\"source\\": \\"<source>\\"
      }
    },
    \\"aws_sns_topic\\": {
      \\"root_mybucket_mybucketoncreate_A862D5F2\\": {
        \\"name\\": \\"my_bucket-on_create-c8ab9ab8\\"
      },
      \\"root_mybucket_mybucketondelete_9854917D\\": {
        \\"name\\": \\"my_bucket-on_delete-c80912e0\\"
      },
      \\"root_mybucket_mybucketonupdate_3B88F935\\": {
        \\"name\\": \\"my_bucket-on_update-c8c80ce5\\"
      }
    },
    \\"aws_sns_topic_policy\\": {
      \\"root_mybucket_mybucketoncreate_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_EF6799F2\\": {
        \\"arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\",
        \\"policy\\": \\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"s3.amazonaws.com\\\\\\"},\\\\\\"Action\\\\\\":\\\\\\"sns:Publish\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\\\\\",\\\\\\"Condition\\\\\\":{\\\\\\"ArnEquals\\\\\\":{\\\\\\"aws:SourceArn\\\\\\":\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}\\\\\\"}}}]}\\"
      },
      \\"root_mybucket_mybucketondelete_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_79FF94E2\\": {
        \\"arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\",
        \\"policy\\": \\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"s3.amazonaws.com\\\\\\"},\\\\\\"Action\\\\\\":\\\\\\"sns:Publish\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\\\\\",\\\\\\"Condition\\\\\\":{\\\\\\"ArnEquals\\\\\\":{\\\\\\"aws:SourceArn\\\\\\":\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}\\\\\\"}}}]}\\"
      },
      \\"root_mybucket_mybucketonupdate_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_FD9F0448\\": {
        \\"arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\",
        \\"policy\\": \\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"s3.amazonaws.com\\\\\\"},\\\\\\"Action\\\\\\":\\\\\\"sns:Publish\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\\\\\",\\\\\\"Condition\\\\\\":{\\\\\\"ArnEquals\\\\\\":{\\\\\\"aws:SourceArn\\\\\\":\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}\\\\\\"}}}]}\\"
      }
    },
    \\"aws_sns_topic_subscription\\": {
      \\"root_mybucket_mybucketoncreate_mybucketoncreateTopicSubscription2c90a36b_30C838B1\\": {
        \\"endpoint\\": \\"\${aws_lambda_function.root_mybucket_mybucketoncreateOnMessage2c90a36b_EAEF907E.arn}\\",
        \\"protocol\\": \\"lambda\\",
        \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketoncreate_A862D5F2.arn}\\"
      },
      \\"root_mybucket_mybucketondelete_mybucketondeleteTopicSubscriptionf22c8a47_D4E0F053\\": {
        \\"endpoint\\": \\"\${aws_lambda_function.root_mybucket_mybucketondeleteOnMessagef22c8a47_43EA3B17.arn}\\",
        \\"protocol\\": \\"lambda\\",
        \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketondelete_9854917D.arn}\\"
      },
      \\"root_mybucket_mybucketonupdate_mybucketonupdateTopicSubscription32b7a290_A5904C22\\": {
        \\"endpoint\\": \\"\${aws_lambda_function.root_mybucket_mybucketonupdateOnMessage32b7a290_F83D69C0.arn}\\",
        \\"protocol\\": \\"lambda\\",
        \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\"
      }
    }
  }
}"
`;

exports[`bucket with onEvent method 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "Code": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformResource",
                  "version": "0.15.2",
                },
                "id": "Code",
                "path": "root/Default/Code",
              },
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
              "inflight": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b",
                    },
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290",
                    },
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "An inflight resource",
                  "hidden": true,
                  "title": "Inflight",
                },
                "id": "inflight",
                "path": "root/Default/inflight",
              },
              "my_bucket": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "outbound",
                      "implicit": false,
                      "relationship": "CREATE",
                      "resource": "root/Default/my_bucket/my_bucket-on_create",
                    },
                    {
                      "direction": "outbound",
                      "implicit": false,
                      "relationship": "UPDATE",
                      "resource": "root/Default/my_bucket/my_bucket-on_update",
                    },
                    {
                      "direction": "outbound",
                      "implicit": false,
                      "relationship": "DELETE",
                      "resource": "root/Default/my_bucket/my_bucket-on_delete",
                    },
                  ],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/my_bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/my_bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/my_bucket/PublicAccessBlock",
                  },
                  "PublicPolicy": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicPolicy",
                    "path": "root/Default/my_bucket/PublicPolicy",
                  },
                  "S3BucketNotification": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "S3BucketNotification",
                    "path": "root/Default/my_bucket/S3BucketNotification",
                  },
                  "my_bucket-on_create": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "CREATE",
                          "resource": "root/Default/my_bucket",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b",
                        },
                      ],
                    },
                    "children": {
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_create/Default",
                      },
                      "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                        "path": "root/Default/my_bucket/my_bucket-on_create/PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                      },
                      "my_bucket-on_create-TopicSubscription-2c90a36b": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "my_bucket-on_create-TopicSubscription-2c90a36b",
                        "path": "root/Default/my_bucket/my_bucket-on_create/my_bucket-on_create-TopicSubscription-2c90a36b",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A pub/sub notification topic",
                      "title": "Topic",
                    },
                    "id": "my_bucket-on_create",
                    "path": "root/Default/my_bucket/my_bucket-on_create",
                  },
                  "my_bucket-on_create-OnMessage-2c90a36b": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/inflight",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/my_bucket-on_create-eventHandler-9eade8f6",
                        },
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_create",
                        },
                      ],
                    },
                    "children": {
                      "Asset": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformAsset",
                          "version": "0.15.2",
                        },
                        "id": "Asset",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/Asset",
                      },
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/Default",
                      },
                      "IamRole": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRole",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/IamRole",
                      },
                      "IamRolePolicy": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicy",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/IamRolePolicy",
                      },
                      "IamRolePolicyAttachment": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicyAttachment",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/IamRolePolicyAttachment",
                      },
                      "InvokePermission-c8ab9ab84a159fe2b8ace0993118785a21c0508190": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "InvokePermission-c8ab9ab84a159fe2b8ace0993118785a21c0508190",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/InvokePermission-c8ab9ab84a159fe2b8ace0993118785a21c0508190",
                      },
                      "S3Object": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "S3Object",
                        "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b/S3Object",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A cloud function (FaaS)",
                      "title": "Function",
                    },
                    "id": "my_bucket-on_create-OnMessage-2c90a36b",
                    "path": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b",
                  },
                  "my_bucket-on_create-OnMessageHandler-2c90a36b": {
                    "attributes": {
                      "wing:resource:connections": [],
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "hidden": true,
                    },
                    "id": "my_bucket-on_create-OnMessageHandler-2c90a36b",
                    "path": "root/Default/my_bucket/my_bucket-on_create-OnMessageHandler-2c90a36b",
                  },
                  "my_bucket-on_delete": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "DELETE",
                          "resource": "root/Default/my_bucket",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47",
                        },
                      ],
                    },
                    "children": {
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_delete/Default",
                      },
                      "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                        "path": "root/Default/my_bucket/my_bucket-on_delete/PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                      },
                      "my_bucket-on_delete-TopicSubscription-f22c8a47": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "my_bucket-on_delete-TopicSubscription-f22c8a47",
                        "path": "root/Default/my_bucket/my_bucket-on_delete/my_bucket-on_delete-TopicSubscription-f22c8a47",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A pub/sub notification topic",
                      "title": "Topic",
                    },
                    "id": "my_bucket-on_delete",
                    "path": "root/Default/my_bucket/my_bucket-on_delete",
                  },
                  "my_bucket-on_delete-OnMessage-f22c8a47": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/inflight",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/my_bucket-on_delete-eventHandler-9eade8f6",
                        },
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_delete",
                        },
                      ],
                    },
                    "children": {
                      "Asset": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformAsset",
                          "version": "0.15.2",
                        },
                        "id": "Asset",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/Asset",
                      },
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/Default",
                      },
                      "IamRole": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRole",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/IamRole",
                      },
                      "IamRolePolicy": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicy",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/IamRolePolicy",
                      },
                      "IamRolePolicyAttachment": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicyAttachment",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/IamRolePolicyAttachment",
                      },
                      "InvokePermission-c80912e0ab47291ff9b0dd966e259f42a42646bcdc": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "InvokePermission-c80912e0ab47291ff9b0dd966e259f42a42646bcdc",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/InvokePermission-c80912e0ab47291ff9b0dd966e259f42a42646bcdc",
                      },
                      "S3Object": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "S3Object",
                        "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47/S3Object",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A cloud function (FaaS)",
                      "title": "Function",
                    },
                    "id": "my_bucket-on_delete-OnMessage-f22c8a47",
                    "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47",
                  },
                  "my_bucket-on_delete-OnMessageHandler-f22c8a47": {
                    "attributes": {
                      "wing:resource:connections": [],
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "hidden": true,
                    },
                    "id": "my_bucket-on_delete-OnMessageHandler-f22c8a47",
                    "path": "root/Default/my_bucket/my_bucket-on_delete-OnMessageHandler-f22c8a47",
                  },
                  "my_bucket-on_update": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "UPDATE",
                          "resource": "root/Default/my_bucket",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290",
                        },
                      ],
                    },
                    "children": {
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_update/Default",
                      },
                      "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                        "path": "root/Default/my_bucket/my_bucket-on_update/PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                      },
                      "my_bucket-on_update-TopicSubscription-32b7a290": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "my_bucket-on_update-TopicSubscription-32b7a290",
                        "path": "root/Default/my_bucket/my_bucket-on_update/my_bucket-on_update-TopicSubscription-32b7a290",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A pub/sub notification topic",
                      "title": "Topic",
                    },
                    "id": "my_bucket-on_update",
                    "path": "root/Default/my_bucket/my_bucket-on_update",
                  },
                  "my_bucket-on_update-OnMessage-32b7a290": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/inflight",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/my_bucket-on_update-eventHandler-9eade8f6",
                        },
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_update",
                        },
                      ],
                    },
                    "children": {
                      "Asset": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformAsset",
                          "version": "0.15.2",
                        },
                        "id": "Asset",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/Asset",
                      },
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/Default",
                      },
                      "IamRole": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRole",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/IamRole",
                      },
                      "IamRolePolicy": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicy",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/IamRolePolicy",
                      },
                      "IamRolePolicyAttachment": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicyAttachment",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/IamRolePolicyAttachment",
                      },
                      "InvokePermission-c8c80ce55fb2dfdf6262f75ee093ef99cc30a57833": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "InvokePermission-c8c80ce55fb2dfdf6262f75ee093ef99cc30a57833",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/InvokePermission-c8c80ce55fb2dfdf6262f75ee093ef99cc30a57833",
                      },
                      "S3Object": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "S3Object",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/S3Object",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A cloud function (FaaS)",
                      "title": "Function",
                    },
                    "id": "my_bucket-on_update-OnMessage-32b7a290",
                    "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290",
                  },
                  "my_bucket-on_update-OnMessageHandler-32b7a290": {
                    "attributes": {
                      "wing:resource:connections": [],
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "hidden": true,
                    },
                    "id": "my_bucket-on_update-OnMessageHandler-32b7a290",
                    "path": "root/Default/my_bucket/my_bucket-on_update-OnMessageHandler-32b7a290",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "my_bucket",
                "path": "root/Default/my_bucket",
              },
              "my_bucket-on_create-eventHandler-9eade8f6": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_create-OnMessage-2c90a36b",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "hidden": true,
                },
                "id": "my_bucket-on_create-eventHandler-9eade8f6",
                "path": "root/Default/my_bucket-on_create-eventHandler-9eade8f6",
              },
              "my_bucket-on_delete-eventHandler-9eade8f6": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_delete-OnMessage-f22c8a47",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "hidden": true,
                },
                "id": "my_bucket-on_delete-eventHandler-9eade8f6",
                "path": "root/Default/my_bucket-on_delete-eventHandler-9eade8f6",
              },
              "my_bucket-on_update-eventHandler-9eade8f6": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "hidden": true,
                },
                "id": "my_bucket-on_update-eventHandler-9eade8f6",
                "path": "root/Default/my_bucket-on_update-eventHandler-9eade8f6",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;

exports[`bucket with onUpdate method 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_iam_role\\": {
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_IamRole_C2D0AC31\\": {
        \\"assume_role_policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Action\\\\\\":\\\\\\"sts:AssumeRole\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"lambda.amazonaws.com\\\\\\"},\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\"}]}\\"
      }
    },
    \\"aws_iam_role_policy\\": {
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_IamRolePolicy_AC650E7C\\": {
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Action\\\\\\":\\\\\\"none:null\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"*\\\\\\"}]}\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketonupdateOnMessage32b7a290_IamRole_C2D0AC31.name}\\"
      }
    },
    \\"aws_iam_role_policy_attachment\\": {
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_IamRolePolicyAttachment_88C3931D\\": {
        \\"policy_arn\\": \\"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\\",
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketonupdateOnMessage32b7a290_IamRole_C2D0AC31.name}\\"
      }
    },
    \\"aws_lambda_function\\": {
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_F83D69C0\\": {
        \\"environment\\": {
          \\"variables\\": {
            \\"WING_FUNCTION_NAME\\": \\"my_bucket-on_update-OnMessage-32b7a290-c875bcdf\\"
          }
        },
        \\"function_name\\": \\"my_bucket-on_update-OnMessage-32b7a290-c875bcdf\\",
        \\"handler\\": \\"index.handler\\",
        \\"publish\\": true,
        \\"role\\": \\"\${aws_iam_role.root_mybucket_mybucketonupdateOnMessage32b7a290_IamRole_C2D0AC31.arn}\\",
        \\"runtime\\": \\"nodejs18.x\\",
        \\"s3_bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"s3_key\\": \\"\${aws_s3_object.root_mybucket_mybucketonupdateOnMessage32b7a290_S3Object_DD9A4CB9.key}\\",
        \\"timeout\\": 30,
        \\"vpc_config\\": {
          \\"security_group_ids\\": [],
          \\"subnet_ids\\": []
        }
      }
    },
    \\"aws_lambda_permission\\": {
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_InvokePermissionc8c80ce55fb2dfdf6262f75ee093ef99cc30a57833_A8A628D7\\": {
        \\"action\\": \\"lambda:InvokeFunction\\",
        \\"function_name\\": \\"\${aws_lambda_function.root_mybucket_mybucketonupdateOnMessage32b7a290_F83D69C0.function_name}\\",
        \\"principal\\": \\"sns.amazonaws.com\\",
        \\"source_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\"
      }
    },
    \\"aws_s3_bucket\\": {
      \\"root_Code_02F3C603\\": {
        \\"bucket_prefix\\": \\"code-c84a50b1-\\"
      },
      \\"root_mybucket_E5DAA363\\": {
        \\"bucket_prefix\\": \\"my-bucket-c8045fcc-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_notification\\": {
      \\"root_mybucket_S3BucketNotification_008BD786\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.id}\\",
        \\"depends_on\\": [
          \\"aws_sns_topic_policy.root_mybucket_mybucketonupdate_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_FD9F0448\\"
        ],
        \\"topic\\": [
          {
            \\"events\\": [
              \\"s3:ObjectCreated:Post\\"
            ],
            \\"id\\": \\"on-update-notification\\",
            \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\"
          }
        ]
      }
    },
    \\"aws_s3_bucket_policy\\": {
      \\"root_mybucket_PublicPolicy_2A65F5BE\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":\\\\\\"*\\\\\\",\\\\\\"Action\\\\\\":[\\\\\\"s3:GetObject\\\\\\"],\\\\\\"Resource\\\\\\":[\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}/*\\\\\\"]}]}\\"
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_mybucket_PublicAccessBlock_3EF88EB3\\": {
        \\"block_public_acls\\": false,
        \\"block_public_policy\\": false,
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"ignore_public_acls\\": false,
        \\"restrict_public_buckets\\": false
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_mybucket_Encryption_AA43F7E8\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    },
    \\"aws_s3_object\\": {
      \\"root_mybucket_mybucketonupdateOnMessage32b7a290_S3Object_DD9A4CB9\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_Code_02F3C603.bucket}\\",
        \\"key\\": \\"<key>\\",
        \\"source\\": \\"<source>\\"
      }
    },
    \\"aws_sns_topic\\": {
      \\"root_mybucket_mybucketonupdate_3B88F935\\": {
        \\"name\\": \\"my_bucket-on_update-c8c80ce5\\"
      }
    },
    \\"aws_sns_topic_policy\\": {
      \\"root_mybucket_mybucketonupdate_PublishPermissionc8045fccc85a7ef42d5391d87958e5ce36c53a401a_FD9F0448\\": {
        \\"arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\",
        \\"policy\\": \\"{\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":{\\\\\\"Service\\\\\\":\\\\\\"s3.amazonaws.com\\\\\\"},\\\\\\"Action\\\\\\":\\\\\\"sns:Publish\\\\\\",\\\\\\"Resource\\\\\\":\\\\\\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\\\\\",\\\\\\"Condition\\\\\\":{\\\\\\"ArnEquals\\\\\\":{\\\\\\"aws:SourceArn\\\\\\":\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}\\\\\\"}}}]}\\"
      }
    },
    \\"aws_sns_topic_subscription\\": {
      \\"root_mybucket_mybucketonupdate_mybucketonupdateTopicSubscription32b7a290_A5904C22\\": {
        \\"endpoint\\": \\"\${aws_lambda_function.root_mybucket_mybucketonupdateOnMessage32b7a290_F83D69C0.arn}\\",
        \\"protocol\\": \\"lambda\\",
        \\"topic_arn\\": \\"\${aws_sns_topic.root_mybucket_mybucketonupdate_3B88F935.arn}\\"
      }
    }
  }
}"
`;

exports[`bucket with onUpdate method 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "Code": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformResource",
                  "version": "0.15.2",
                },
                "id": "Code",
                "path": "root/Default/Code",
              },
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
              "inflight": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "An inflight resource",
                  "hidden": true,
                  "title": "Inflight",
                },
                "id": "inflight",
                "path": "root/Default/inflight",
              },
              "my_bucket": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "outbound",
                      "implicit": false,
                      "relationship": "UPDATE",
                      "resource": "root/Default/my_bucket/my_bucket-on_update",
                    },
                  ],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/my_bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/my_bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/my_bucket/PublicAccessBlock",
                  },
                  "PublicPolicy": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicPolicy",
                    "path": "root/Default/my_bucket/PublicPolicy",
                  },
                  "S3BucketNotification": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "S3BucketNotification",
                    "path": "root/Default/my_bucket/S3BucketNotification",
                  },
                  "my_bucket-on_update": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "UPDATE",
                          "resource": "root/Default/my_bucket",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290",
                        },
                      ],
                    },
                    "children": {
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_update/Default",
                      },
                      "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                        "path": "root/Default/my_bucket/my_bucket-on_update/PublishPermission-c8045fccc85a7ef42d5391d87958e5ce36c53a401a",
                      },
                      "my_bucket-on_update-TopicSubscription-32b7a290": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "my_bucket-on_update-TopicSubscription-32b7a290",
                        "path": "root/Default/my_bucket/my_bucket-on_update/my_bucket-on_update-TopicSubscription-32b7a290",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A pub/sub notification topic",
                      "title": "Topic",
                    },
                    "id": "my_bucket-on_update",
                    "path": "root/Default/my_bucket/my_bucket-on_update",
                  },
                  "my_bucket-on_update-OnMessage-32b7a290": {
                    "attributes": {
                      "wing:resource:connections": [
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/inflight",
                        },
                        {
                          "direction": "outbound",
                          "implicit": false,
                          "relationship": "handle",
                          "resource": "root/Default/my_bucket-on_update-eventHandler-9eade8f6",
                        },
                        {
                          "direction": "inbound",
                          "implicit": false,
                          "relationship": "on_message",
                          "resource": "root/Default/my_bucket/my_bucket-on_update",
                        },
                      ],
                    },
                    "children": {
                      "Asset": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformAsset",
                          "version": "0.15.2",
                        },
                        "id": "Asset",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/Asset",
                      },
                      "Default": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "Default",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/Default",
                      },
                      "IamRole": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRole",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/IamRole",
                      },
                      "IamRolePolicy": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicy",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/IamRolePolicy",
                      },
                      "IamRolePolicyAttachment": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "IamRolePolicyAttachment",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/IamRolePolicyAttachment",
                      },
                      "InvokePermission-c8c80ce55fb2dfdf6262f75ee093ef99cc30a57833": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "InvokePermission-c8c80ce55fb2dfdf6262f75ee093ef99cc30a57833",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/InvokePermission-c8c80ce55fb2dfdf6262f75ee093ef99cc30a57833",
                      },
                      "S3Object": {
                        "constructInfo": {
                          "fqn": "cdktf.TerraformResource",
                          "version": "0.15.2",
                        },
                        "id": "S3Object",
                        "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290/S3Object",
                      },
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "description": "A cloud function (FaaS)",
                      "title": "Function",
                    },
                    "id": "my_bucket-on_update-OnMessage-32b7a290",
                    "path": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290",
                  },
                  "my_bucket-on_update-OnMessageHandler-32b7a290": {
                    "attributes": {
                      "wing:resource:connections": [],
                    },
                    "constructInfo": {
                      "fqn": "constructs.Construct",
                      "version": "10.1.245",
                    },
                    "display": {
                      "hidden": true,
                    },
                    "id": "my_bucket-on_update-OnMessageHandler-32b7a290",
                    "path": "root/Default/my_bucket/my_bucket-on_update-OnMessageHandler-32b7a290",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "my_bucket",
                "path": "root/Default/my_bucket",
              },
              "my_bucket-on_update-eventHandler-9eade8f6": {
                "attributes": {
                  "wing:resource:connections": [
                    {
                      "direction": "inbound",
                      "implicit": false,
                      "relationship": "handle",
                      "resource": "root/Default/my_bucket/my_bucket-on_update-OnMessage-32b7a290",
                    },
                  ],
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "hidden": true,
                },
                "id": "my_bucket-on_update-eventHandler-9eade8f6",
                "path": "root/Default/my_bucket-on_update-eventHandler-9eade8f6",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;

exports[`bucket with two preflight objects 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_s3_bucket\\": {
      \\"root_mybucket_E5DAA363\\": {
        \\"bucket_prefix\\": \\"my-bucket-c8045fcc-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_policy\\": {
      \\"root_mybucket_PublicPolicy_2A65F5BE\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"policy\\": \\"{\\\\\\"Version\\\\\\":\\\\\\"2012-10-17\\\\\\",\\\\\\"Statement\\\\\\":[{\\\\\\"Effect\\\\\\":\\\\\\"Allow\\\\\\",\\\\\\"Principal\\\\\\":\\\\\\"*\\\\\\",\\\\\\"Action\\\\\\":[\\\\\\"s3:GetObject\\\\\\"],\\\\\\"Resource\\\\\\":[\\\\\\"\${aws_s3_bucket.root_mybucket_E5DAA363.arn}/*\\\\\\"]}]}\\"
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_mybucket_PublicAccessBlock_3EF88EB3\\": {
        \\"block_public_acls\\": false,
        \\"block_public_policy\\": false,
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"ignore_public_acls\\": false,
        \\"restrict_public_buckets\\": false
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_mybucket_Encryption_AA43F7E8\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    },
    \\"aws_s3_object\\": {
      \\"root_mybucket_S3Objectfile1txt_B3E3D89E\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"content\\": \\"hello world\\",
        \\"key\\": \\"file1.txt\\"
      },
      \\"root_mybucket_S3Objectfile2txt_FC04216D\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"content\\": \\"boom bam\\",
        \\"key\\": \\"file2.txt\\"
      }
    }
  }
}"
`;

exports[`bucket with two preflight objects 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
              "my_bucket": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/my_bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/my_bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/my_bucket/PublicAccessBlock",
                  },
                  "PublicPolicy": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicPolicy",
                    "path": "root/Default/my_bucket/PublicPolicy",
                  },
                  "S3Object-file1.txt": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "S3Object-file1.txt",
                    "path": "root/Default/my_bucket/S3Object-file1.txt",
                  },
                  "S3Object-file2.txt": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "S3Object-file2.txt",
                    "path": "root/Default/my_bucket/S3Object-file2.txt",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "my_bucket",
                "path": "root/Default/my_bucket",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;

exports[`create a bucket 1`] = `
"{
  \\"output\\": {
    \\"WING_TEST_RUNNER_FUNCTION_ARNS\\": {
      \\"value\\": \\"[]\\"
    }
  },
  \\"resource\\": {
    \\"aws_s3_bucket\\": {
      \\"root_mybucket_E5DAA363\\": {
        \\"bucket_prefix\\": \\"my-bucket-c8045fcc-\\",
        \\"force_destroy\\": false
      }
    },
    \\"aws_s3_bucket_public_access_block\\": {
      \\"root_mybucket_PublicAccessBlock_3EF88EB3\\": {
        \\"block_public_acls\\": true,
        \\"block_public_policy\\": true,
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"ignore_public_acls\\": true,
        \\"restrict_public_buckets\\": true
      }
    },
    \\"aws_s3_bucket_server_side_encryption_configuration\\": {
      \\"root_mybucket_Encryption_AA43F7E8\\": {
        \\"bucket\\": \\"\${aws_s3_bucket.root_mybucket_E5DAA363.bucket}\\",
        \\"rule\\": [
          {
            \\"apply_server_side_encryption_by_default\\": {
              \\"sse_algorithm\\": \\"AES256\\"
            }
          }
        ]
      }
    }
  }
}"
`;

exports[`create a bucket 2`] = `
{
  "tree": {
    "children": {
      "root": {
        "children": {
          "Default": {
            "children": {
              "aws": {
                "constructInfo": {
                  "fqn": "cdktf.TerraformProvider",
                  "version": "0.15.2",
                },
                "id": "aws",
                "path": "root/Default/aws",
              },
              "cloud.TestRunner": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "TestFunctionArns": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformOutput",
                      "version": "0.15.2",
                    },
                    "id": "TestFunctionArns",
                    "path": "root/Default/cloud.TestRunner/TestFunctionArns",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A suite of APIs for running tests and collecting results.",
                  "hidden": true,
                  "title": "TestRunner",
                },
                "id": "cloud.TestRunner",
                "path": "root/Default/cloud.TestRunner",
              },
              "my_bucket": {
                "attributes": {
                  "wing:resource:connections": [],
                },
                "children": {
                  "Default": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Default",
                    "path": "root/Default/my_bucket/Default",
                  },
                  "Encryption": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "Encryption",
                    "path": "root/Default/my_bucket/Encryption",
                  },
                  "PublicAccessBlock": {
                    "constructInfo": {
                      "fqn": "cdktf.TerraformResource",
                      "version": "0.15.2",
                    },
                    "id": "PublicAccessBlock",
                    "path": "root/Default/my_bucket/PublicAccessBlock",
                  },
                },
                "constructInfo": {
                  "fqn": "constructs.Construct",
                  "version": "10.1.245",
                },
                "display": {
                  "description": "A cloud object store",
                  "title": "Bucket",
                },
                "id": "my_bucket",
                "path": "root/Default/my_bucket",
              },
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.1.245",
            },
            "id": "Default",
            "path": "root/Default",
          },
          "backend": {
            "constructInfo": {
              "fqn": "cdktf.LocalBackend",
              "version": "0.15.2",
            },
            "id": "backend",
            "path": "root/backend",
          },
        },
        "constructInfo": {
          "fqn": "cdktf.TerraformStack",
          "version": "0.15.2",
        },
        "id": "root",
        "path": "root",
      },
    },
    "constructInfo": {
      "fqn": "cdktf.App",
      "version": "0.15.2",
    },
    "id": "App",
    "path": "",
  },
  "version": "tree-0.1",
}
`;
